From 4563c61f6e2ac73634f8b75871da2d9e7ed07645 Mon Sep 17 00:00:00 2001
From: rewine <lhongxu@outlook.com>
Date: Mon, 16 Jan 2023 01:11:35 +0800
Subject: [PATCH] fix path for nixos

---
 src/vendor/src/libxsys/FileSystem/FileSystem.cpp | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/src/vendor/src/libxsys/FileSystem/FileSystem.cpp b/src/vendor/src/libxsys/FileSystem/FileSystem.cpp
index c3d4b28..ef320f0 100644
--- a/src/vendor/src/libxsys/FileSystem/FileSystem.cpp
+++ b/src/vendor/src/libxsys/FileSystem/FileSystem.cpp
@@ -25,7 +25,7 @@ QString TmpFilePath(const QString &filename, const QString &distFilename)
 {
 //fix bug 16574 非开发者模式第三方程序无法签名的问题，现将第三放程序写到/usr/bin下面，mac平台保持原样
 #ifdef Q_OS_LINUX
-    QString tmpDir = "/usr/bin/";
+    QString tmpDir = QStandardPaths::standardLocations(QStandardPaths::AppDataLocation).first();
 #endif
 #ifndef Q_OS_LINUX
     QString tmpDir = QStandardPaths::standardLocations(QStandardPaths::AppDataLocation).first();
@@ -184,7 +184,8 @@ QString PathSearch(const QString &filename, const QStringList &pathlist)
 
 QString SearchBin(const QString &binName)
 {
-    QStringList paths;
+    QStringList paths = QString::fromLatin1(qgetenv("PATH"))
+	                .split(QLatin1Char(':'), QString::SkipEmptyParts);
     paths.push_back("/sbin/");
     paths.push_back("/usr/sbin/");
     paths.push_back("/bin/");
-- 
2.39.2

